# -*- coding: utf-8 -*-

import matplotlib.pyplot as plt
import pandas as pd
import numpy as np

dfTrain=pd.read_csv('datasets/definitive/train/segments_relative_size_10868samples.csv')
dfTest=pd.read_csv('datasets/definitive/test/segments_relative_size_10868samples.csv')

#print dfTrain.columns
#print dfTest.columns

trainSegmentsArray = dfTrain.columns.values
testSegmentsArray = dfTest.columns.values

trainSegmentsList = list(trainSegmentsArray)
testSegmentsList = list(testSegmentsArray)

#trainSegmentsList.remove('category')
#trainSegmentsList.remove('sample_id')
#trainSegmentsList.remove('Unnamed: 0')

#testSegmentsList.remove('category')
#testSegmentsList.remove('sample_id')
#testSegmentsList.remove('Unnamed: 0')

#print trainSegments
#print testSegments

#commonSegments = list(set(trainSegmentsArray) & set(testSegmentsArray))
commonSegments = list(set(trainSegmentsList) & set(testSegmentsList))
#trainNotInTest = list(set(trainSegmentsList) | set(testSegmentsList))
#trainNotInTest = list(set(testSegmentsList) | set(trainSegmentsList))
#trainNotInTest = list(set(trainSegmentsList) - set(commonSegments))
#testNotInTrain = list(set(testSegmentsList) - set(commonSegments))

#print len(commonSegments)
#print sorted(commonSegments)
#print trainNotInTest
#print commonSegments
#print testNotInTrain

#for colName in testNotInTrain:
#    dfTest.drop(colName,inplace=True,axis=1)

for colName in dfTrain.columns.values:
    if colName not in commonSegments:
        dfTrain.drop(colName,inplace=True,axis=1)
        
for colName in dfTest.columns.values:
    if colName not in commonSegments:
        dfTest.drop(colName,inplace=True,axis=1)


trainColumns = dfTrain.columns.tolist()
testColumns = dfTest.columns.tolist()


#print trainColumns
#print trainColumns[-1:]
#print trainColumns[:-1]
#print trainColumns[2:-1]

arrangedTrainColumns = trainColumns[0:2] + sorted(trainColumns[2:-1]) + trainColumns[-1:]
arrangedTestColumns = testColumns[0:2] + sorted(testColumns[2:-1]) + testColumns[-1:]

#print arrangedTrainColumns
#print arrangedTestColumns
dftr = dfTrain[arrangedTrainColumns]
dfts = dfTest[arrangedTestColumns]

print dftr.head()
print dfts.head()

"""
dftr = dfTrain.reindex_axis(sorted(dfTrain.columns), axis=1)
dfts = dfTest.reindex_axis(sorted(dfTest.columns), axis=1)


print list(dfTrain.columns.values)
print list(dfTest.columns.values)

print list(dftr.columns.values)
print list(dfts.columns.values)
"""