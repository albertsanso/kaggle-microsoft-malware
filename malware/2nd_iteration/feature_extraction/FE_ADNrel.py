# -*- coding: utf-8 -*-
"""
Created on Sat Apr 11 13:25:11 2015

@author: Jordi
"""

import pandas as pd
    
def featureExtractionAdnRel(adnAbs):
    colNames = adnAbs.columns
    adnAbs = adnAbs.values
    adnAbsNum = adnAbs[:,1:].astype(float)   
    for i in xrange(len(adnAbsNum)):
        row = adnAbs[i,1:]    
        sumCol = row.sum()
        if sumCol != 0:    
            for j in (xrange(len(row))):
                adnAbs[i,j+1] = adnAbsNum[i,j]/sumCol
    adnRel = pd.DataFrame(adnAbs, columns = colNames)
    return adnRel

#### main ####
adnAbs = pd.read_csv("work/malware/2nd_iteration/datasets/single/train/ADN1abs_Train.csv")
adnAbs.drop('Unnamed: 0', axis = 1, inplace = True)
adnRel = featureExtractionAdnRel(adnAbs)    
adnRel.to_csv("work/malware/2nd_iteration/datasets/single/train/ADN1rel_Train.csv", index = False)

adnAbs = pd.read_csv("work/malware/2nd_iteration/datasets/single/test/ADN1abs_Test.csv")
adnAbs.drop('Unnamed: 0', axis = 1, inplace = True)
adnRel = featureExtractionAdnRel(adnAbs)    
adnRel.to_csv("work/malware/2nd_iteration/datasets/single/test/ADN1rel_Test.csv", index = False)

adnAbs = pd.read_csv("work/malware/2nd_iteration/datasets/single/train/ADN2abs_Train.csv")
adnRel = featureExtractionAdnRel(adnAbs)    
adnRel.to_csv("work/malware/2nd_iteration/datasets/single/train/ADN2rel_Train.csv", index = False)

adnAbs = pd.read_csv("work/malware/2nd_iteration/datasets/single/test/ADN2abs_Test.csv")
adnRel = featureExtractionAdnRel(adnAbs)    
adnRel.to_csv("work/malware/2nd_iteration/datasets/single/test/ADN2rel_Test.csv", index = False)
