# -*- coding: utf-8 -*-

import pandas as pd
import numpy as np

def combineFilesById(file_left, file_right, rightColumn, leftColumn):
    
    dfLeft = pd.read_csv(file_left)
    dfRight = pd.read_csv(file_right)
    
    return combineDataFramesById(dfLeft, dfRight, rightColumn, leftColumn)
    
def combineDataFramesById(dfLeft, dfRight, rightColumn, leftColumn):
    
    mergedDf = pd.merge(dfLeft, dfRight, how='left', left_on=leftColumn, right_on=rightColumn)
    mergedDf.drop('category', axis=1, inplace=True)
    #mergedDf.rename(columns = {'category_y':'category'}, inplace=True)
        
    return mergedDf
    
    
# -----------------------------------------------------------------------------
    
#leftFile = "c:/datamandanga/git/malware/work/malware/datasets/definitive/train/sections_relative_size_intersect.csv"
#rightFile = "c:/datamandanga/git/malware/work/malware/datasets/definitive/train/files_sizes_train.csv"

#leftFile = "c:/dev/source/python/work/bitbucket/malware/work/malware/datasets/definitive/train/segments_relative_size_10868samples_intersect.csv"
#rightFile = "c:/dev/source/python/work/bitbucket/malware/work/malware/datasets/definitive/train/files_sizes_train.csv"

#leftFile = "c:/dev/source/python/work/bitbucket/malware/work/malware/2nd_iteration/datasets/single/train/imports_count_all.csv"
#leftFile = "c:/dev/source/python/work/bitbucket/malware/work/malware/2nd_iteration/datasets/single/train/win32_api_calls_1_filter_1.csv"
#rightFile = "c:/dev/source/python/work/bitbucket/malware/work/malware/2nd_iteration/datasets/single/train/train_sections_size.csv"

leftFile = "c:/dev/source/python/work/bitbucket/malware/work/malware/2nd_iteration/datasets/single/test/SSabs+FSasm+ADN1abs+ADN2abs+ADN1rel+ADN2rel_Test.csv"
#rightFile = "c:/dev/source/python/work/bitbucket/malware/work/malware/2nd_iteration/datasets/single/train/train_sections_size.csv"
#leftFile = "c:/dev/source/python/work/bitbucket/malware/work/malware/2nd_iteration/datasets/single/train/join2.csv"
#rightFile = "c:/dev/source/python/work/bitbucket/malware/work/malware/2nd_iteration/datasets/single/train/win32_api_calls_1_non_filter.csv"
rightFile = "c:/dev/source/python/work/bitbucket/malware/work/malware/2nd_iteration/datasets/single/test/FSbytes_test.csv"
df = combineFilesById(leftFile, rightFile, 'id', 'id')
print df.head()
print np.shape(df)


df.to_csv("c:/dev/source/python/work/bitbucket/malware/work/malware/2nd_iteration/datasets/single/test/join4.csv", index=False)

"""
df2 = pd.read_csv("c:/dev/source/python/work/bitbucket/malware/work/malware/2nd_iteration/datasets/single/train/win32_api_calls_1_filter_1.csv")

df3 = combineDataFramesById(df, df2, 'id', 'id')
#print df3.head()
print np.shape(df3)
"""